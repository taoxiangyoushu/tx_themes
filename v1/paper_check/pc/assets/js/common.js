var systemInfo = {
	wanfangbd: {
		name: '万方本科',
		comparisonLibrary: '中国学术期刊数据库、中国标准全文数据库、中国优秀报纸全文数据库、中国专利文献全文数据库、中国博士学位论文全文数据库、中国优秀硕士学位论文全文数据、国内外重要学、会议论文数据库、优先出版论文数据库、互联网学术资源数据库、学术网络文献数据库、特色英文文摘数据库',
		detectionAlgorithm: '',
		Language: '中文',
		detectionScope: '专科、本科论文',
		timeConsuming: '1-5分钟',
		reportSample: '',
		applyUser: '',
	},
	wanfangmd: {
		name: '万方硕博',
		comparisonLibrary: '中国学术期刊数据库、中国标准全文数据库、中国优秀报纸全文数据库、中国专利文献全文数据库、中国博士学位论文全文数据库、中国优秀硕士学位论文全文数据、国内外重要学、会议论文数据库、优先出版论文数据库、互联网学术资源数据库、学术网络文献数据库、特色英文文摘数据库',
		detectionAlgorithm: '',
		Language: '中文',
		detectionScope: '硕士、博士、MBA论文',
		timeConsuming: '1-5分钟',
		reportSample: '',
		applyUser: '',
	},
	wanfanggl: {
		name: '万方通用',
		comparisonLibrary: '中国学术期刊数据库、中国标准全文数据库、中国优秀报纸全文数据库、中国专利文献全文数据库、中国博士学位论文全文数据库、中国优秀硕士学位论文全文数据、国内外重要学、会议论文数据库、优先出版论文数据库、互联网学术资源数据库、学术网络文献数据库、特色英文文摘数据库',
		detectionAlgorithm: '',
		Language: '中文',
		detectionScope: '本科、专科、硕士、博士、职称、期刊、MBA论文',
		timeConsuming: '1-5分钟',
		reportSample: '',
		applyUser: '',
	},
	wanfangpu: {
		name: '万方职称',
		comparisonLibrary: '中国学术期刊数据库、中国标准全文数据库、中国优秀报纸全文数据库、中国专利文献全文数据库、中国博士学位论文全文数据库、中国优秀硕士学位论文全文数据、国内外重要学、会议论文数据库、优先出版论文数据库、互联网学术资源数据库、学术网络文献数据库、特色英文文摘数据库',
		detectionAlgorithm: '',
		Language: '中文',
		detectionScope: '职称、期刊论文',
		timeConsuming: '1-5分钟',
		reportSample: '',
		applyUser: '',
	},
	cqvip: {
		name: '维普本科',
		comparisonLibrary: '中文科技期刊论文全文数据库、博士/硕士学位论文全文数据库、外文特色文献数据全库、中文主要报纸全文数据库、中国主要会议论文特色数据库、高校论文联合比对库、中国专利特色数据库、维普优先出版论文全文数据库、互联网数据资源/互联网文档资源、港澳台文献资源、图书资源、高校自建资源库、个人自建资源、库年鉴资源、古籍文献资源、IPUB原创作品',
		detectionAlgorithm: '该系统采用自主研发的核心算法技术，较其他检测系统具有检测原理先进、效率高、误判率低等优势。',
		Language: '中文、英文、小语种',
		detectionScope: '本科、专科论文',
		timeConsuming: '10-30分钟',
		reportSample: '',
		applyUser: '',
	},
	cqvipmd: {
		name: '维普硕博',
		comparisonLibrary: '中文科技期刊论文全文数据库、博士/硕士学位论文全文数据库、外文特色文献数据全库、中文主要报纸全文数据库、中国主要会议论文特色数据库、高校论文联合比对库、中国专利特色数据库、维普优先出版论文全文数据库、互联网数据资源/互联网文档资源、港澳台文献资源、图书资源、高校自建资源库、个人自建资源、库年鉴资源、古籍文献资源、IPUB原创作品',
		detectionAlgorithm: '该系统采用自主研发的核心算法技术，较其他检测系统具有检测原理先进、效率高、误判率低等优势。',
		Language: '中文、英文、小语种',
		detectionScope: '硕士、博士、MBA论文',
		timeConsuming: '10-30分钟',
		reportSample: '',
		applyUser: '',
	},
	cqvipzc: {
		name: '维普职称',
		comparisonLibrary: '中外期刊数据库、学术会议论文库、硕博学位论文库、特色自建论文库、互联网数据资源',
		detectionAlgorithm: '该系统采用自主研发的核心算法技术，较其他检测系统具有检测原理先进、效率高、误判率低等优势。',
		Language: '中文、英文、小语种',
		detectionScope: '职称、期刊论文',
		timeConsuming: '10-30分钟',
		reportSample: '',
		applyUser: '',
	},
	cqvipbj: {
		name: '维普编辑部版',
		comparisonLibrary: '系统目前整合入库用于比对的文献资源除数十亿网页资源外， 现已超过6千多万篇文献且每周不断更新，涵盖中国网络论文库、中国科技论文库、中国期刊论文网络数据库、 中文科技期刊数据库、中文重要学术期刊库、中国重要文科期刊库、中国中文报刊报纸数据库、 重要外文期刊数据库等以及数百万的学位论文、高校特色论文库等',
		detectionAlgorithm: '该系统采用自主研发的核心算法技术，较其他检测系统具有检测原理先进、效率高、误判率低等优势。',
		Language: '中文、英文、小语种',
		detectionScope: '职称、期刊',
		timeConsuming: '10-30分钟',
		reportSample: '',
		applyUser: '',
	},
	cqvipaigc: {
		name: '维普AIGC检测',
		aigcIntroduce: 'AIGC（Artificial Intelligence Generated Content），即人工智能生成内容。AIGC检测仅检测文章内AI生成文本内容，可快速、精准地识别文本内容是否由AI模型生成，并提供包含疑似AI生成可能性百分比、疑似AI生成片段等内容的AIGC检测报告。',
		comparisonLibrary: '',
		detectionAlgorithm: '',
		Language: '中文、英文',
		detectionScope: '包括但不限于 ChatGPT、文心一言、谷歌 Bard、通义千问、必应 ChatGpt、ChatSonic 和其他 AI 写作助手生成的中文或英文文本',
		timeConsuming: '10-30分钟',
		reportSample: '',
		applyUser: '',
	},
	cqvipgs: {
		name: '维普格式检测大学生版',
		comparisonLibrary: '适用于专科、本科论文格式检测，使用国家通用格式标准模板；支持文本，插图，表格，参考文献等多个检测项。',
		detectionAlgorithm: '',
		Language: '中文、英文',
		detectionScope: '专科、本科论文',
		timeConsuming: '10-30分钟',
		reportSample: '',
		applyUser: '',
	},
	paperPass: {
		name: 'PaerPass',
		comparisonLibrary: '学术期刊（1990-2019）、学位论文（硕博库1990-2019）、会议论文（1990-2019）、书籍数据（1990-2017）、互联网资源',
		detectionAlgorithm: '',
		Language: '中文',
		detectionScope: '本科、专科、硕博论文',
		timeConsuming: '10-30分钟',
		reportSample: '',
		applyUser: '',
	},
	checkPass: {
		name: 'CheckPass',
		comparisonLibrary: '',
		detectionAlgorithm: '论文检测系统基于强大的精准检测算法以及稳定快速的检测云服务器；严格、准确、高效的论文检测系统，能够查出文献中所存在的学术不端等问题。',
		Language: '中文、英文',
		detectionScope: '本科、专科、硕士、博士、职称、期刊、MBA论文',
		timeConsuming: '2-20分钟',
		reportSample: '',
		applyUser: '',
	},
	zaojiance: {
		name: '早检测',
		comparisonLibrary: '早检测论文查重系统数据库超百亿，含海量学术期刊、学位论文、 会议报纸、图书书籍以及互联网资源',
		detectionAlgorithm: '',
		Language: '中文',
		detectionScope: '本科、专科、硕博',
		timeConsuming: '5-10分钟',
		reportSample: '',
		applyUser: '',
	},
	turnitinai: {
		name: 'Turnitin国际版+AI',
		comparisonLibrary: '',
		detectionAlgorithm: '',
		Language: '中文、英文、小语种（AI率检测仅支持英文，其它语言无法检测，也无法出AI率报告）',
		detectionScope: '留学生、SCI论文、EI论文、英文写作论文',
		timeConsuming: '10-30分钟',
		reportSample: '',
		applyUser: '非英国地区学校外语论文检测，留学生等国际论文',
	},
	turnitinuk: {
		name: 'TurnitinUK',
		comparisonLibrary: '',
		detectionAlgorithm: '',
		Language: '中文、英文、小语种',
		detectionScope: '留学生、SCI论文、EI论文、英文写作论文',
		timeConsuming: '10-30分钟',
		reportSample: '',
		applyUser: '在英国留学的学生使用，英国大学的论文请选择UK版',
	},
	turnitin: {
		name: 'Turnitin',
		comparisonLibrary: '',
		detectionAlgorithm: '',
		Language: '中文、英文、小语种',
		detectionScope: '留学生、SCI论文、EI论文、英文写作论文',
		timeConsuming: '10-30分钟',
		reportSample: '',
		applyUser: '非英国地区学校外语论文检测，留学生等国际论文',
	},
	ithenticate: {
		name: 'iThenticate',
		comparisonLibrary: '700+亿份在线和存档网页、135000000篇文章、书籍、会议记录、预印本、百科全书和摘要，69000000+付费学术文章、书籍和会议记录，可检测几乎所有语种的文章',
		detectionAlgorithm: '',
		Language: '英文',
		detectionScope: '留学生、SCI论文、EI论文、英文写作论文',
		timeConsuming: '30-60分钟',
		reportSample: '',
		applyUser: '',
	},
	dashichachong: {
		name: '大师查重',
		comparisonLibrary: '覆盖图书、期刊、学位论文、会议论文、专利、标准、互联网数据，数据实时更新范围更广。',
		detectionAlgorithm: '动态指纹对比检测技术，AI智能特征对比算法，智能算法预处理学科分类，轻松识别参考文献、附录，查重报告保留7天，安全无痕。',
		Language: '中文、英文',
		detectionScope: '',
		timeConsuming: '3分钟',
		reportSample: '',
		applyUser: '',
	},
	paperyy: {
		name: 'PaperYY',
		comparisonLibrary: '覆盖图书、期刊、学位论文、会议论文、专利、标准、互联网数据,数据实时更新范围更广',
		detectionAlgorithm: '',
		Language: '中文、英文',
		detectionScope: '',
		timeConsuming: '1-10分钟',
		reportSample: '',
		applyUser: '',
	},
	grammarly: {
		name: 'Grammarly语法检测',
		comparisonLibrary: '',
		detectionAlgorithm: 'GramMarly提供拼写校正(Spell Checking)，语境分析下的词汇应用纠正(Contextual Spelling Check)，语法规则纠正(Grammar)，标点符号纠正(Punctuation)，句式架构纠正(Sentence Structure)等基础功能，文章类型预判(Document Type，可根据不同类型的文章进行校对)',
		Language: '英文',
		detectionScope: ' 留学生、SCI论文、EI论文、英文写作论文',
		timeConsuming: '5-10分钟',
		reportSample: '',
		applyUser: '',
	},
	ywjbd: {
		name: '源文鉴本科',
		comparisonLibrary: '100000000篇中文文献，1000万篇各类独家文献，300万港澳台地区学术文献4000万篇英文文献资源，20个亿中英文互联网资源是全国高校用来检测硕博论文的检测系统',
		detectionAlgorithm: '',
		Language: '中文、英文',
		detectionScope: '',
		timeConsuming: '10-30分钟',
		reportSample: '',
		applyUser: '',
	},
	ywjmd: {
		name: '源文鉴硕博',
		comparisonLibrary: '100000000篇中文文献，1000万篇各类独家文献，300万港澳台地区学术文献4000万篇英文文献资源，20个亿中英文互联网资源是全国高校用来检测硕博论文的检测系统',
		detectionAlgorithm: '',
		Language: '中文、英文',
		detectionScope: '',
		timeConsuming: '10-30分钟',
		reportSample: '',
		applyUser: '',
	}
}

// 封装url参数获取
function getQueryVariable(variable){
	var query = window.location.search.substring(1);
	var vars = query.split("&");
	for (var i=0;i<vars.length;i++) {
			var pair = vars[i].split("=");
			if(pair[0] == variable){return decodeURI(pair[1]);}
	}
	return(false);
}

let act_code = ''
if(getQueryVariable('ac')){
	act_code = getQueryVariable('ac')
	window.localStorage.setItem('act_code',getQueryVariable('ac'))
}else{
	if(window.localStorage.getItem('act_code')){
		act_code = window.localStorage.getItem('act_code')
	}
}
let suffix = ''
if(act_code){
	suffix = 'act_code='+ act_code +'&_session_type=user'
}

let dct_code = ''
if(getQueryVariable('dc')) {
	dct_code = getQueryVariable('dc')
	window.localStorage.setItem('dct_code',getQueryVariable('dc'))
}else{
	if(window.localStorage.getItem('dct_code')){
		dct_code = window.localStorage.getItem('dct_code')
	}
}
let suffix2 = ''
if(dct_code){
	suffix2 = 'dct_code='+ dct_code
}

let inv_code = ''
if(getQueryVariable('iCode')) {
	inv_code = getQueryVariable('iCode')
	window.localStorage.setItem('inv_code',getQueryVariable('iCode'))
}else{
	if(window.localStorage.getItem('inv_code')){
		inv_code = window.localStorage.getItem('inv_code')
	}
}
var urls = 'https://api.taoxiangyoushu.com'//http://api.project_libraries.report
function getFormData(object) {
    // 转FromData 对象
    var formData = new FormData();
    Object.keys(object).forEach(function (key) {
        var value = object[key];
        if (Array.isArray(value)) {
            value.forEach(function (subValue, i) {
                formData.append(key + "[" + i + "]", subValue);
            });
        } else {
            formData.append(key, object[key]);
        }
    });
    return formData;
}

var selling_price = ''
var isclick = false
var parameterSet = {}
var threeMsg = {}
var payWayInfo= {}
var memberFu = {}
window.onload = function (){
	$.ajax({
		type: 'post',
		url: urls + "/api/project/info?user_token="+USER_TOKEN+"&jane_name="+JANE_NAME +(suffix?'&'+suffix:'') + (suffix2?'&'+suffix2:''),
		data: {
			ident: 'check'
		},
		xhrFields: {
			withCredentials: true
		},
		success: function success(result) {
			if(result.code == '200') {
				var data = result.data
				// var info = data.project[0].goods_info[0]
				// selling_price = info.selling_price

				var seller_info = data.seller_info
				threeMsg = data.project[0].threeMsg
				$(".customerBox .customer-title").text(seller_info.kf_title || '联系客服')
				$(".customerBox .customer-qr").attr('src', seller_info.kf_qr || '')
				$('.customerBox .qqText .s1').text(seller_info.qq || '')
				$('.customerBox .telephone .s1').text(seller_info.phone || '')
				$('.customerBox .mailbox .s1').text(seller_info.email || '')
				$('.customerBox .wxText .s1').text(seller_info.wx || '')
				if(seller_info.qq) $('.customerBox  .qqText').show();
				if(seller_info.phone) $('.customerBox  .telephone').show();
				if(seller_info.email) $('.customerBox  .mailbox').show();
				if(seller_info.wx) $('.customerBox  .wxText').show();
				if(seller_info.kf_qr){
					$(".customerBox .customerCode").show()
				}else{
					$(".customerBox .customerCode").hide()
				}
				if(seller_info.qq || seller_info.phone || seller_info.email || seller_info.wx){
					$(".customerBox .customerWay").show()
				}else{
					$(".customerBox .customerWay").hide()
				}
				if(seller_info.kf_qr && (seller_info.qq || seller_info.phone || seller_info.email || seller_info.wx)){
					$(".customerBox .segmentation-line").show()
				}else{
					$(".customerBox .segmentation-line").hide()
				}
				if(!seller_info.qq && !seller_info.phone && !seller_info.email && !seller_info.wx && !seller_info.kf_qr){
					$(".noCustomer").show()
				}else{
					$(".noCustomer").hide()
				}

				// 重组数据
				typefun(data.project[0].goods_info)
				setArguments(data.project[0].goods_info)
				isclick = true

				if($(".pay_page").length > 0){
					tacitPay(typeData, data.project[0].pay_way, data.pay_config)
					setPriceTips(data.project[0].goods_info)
				}
				if($('.home_page').length) {
					dropDownType(typeData)
					getFormaTemplate()
				}
				payWayInfo = data.project[0].pay_way

				memberFu = new member ({
					ele	 : '#memberCarrier', // 插入节点
					urls : urls, // 接口域名
					whether: data.project[0].link_config, // 网站配置信息
					USER_TOKEN: USER_TOKEN,
					JANE_NAME: JANE_NAME,
					success_info: function(e){ // 获取用户成功回调
						if($('#App').data('key') == 'queryApp') {
							query(e)
						}
						if(e.is_distributor	&& e.is_bind_phone) {
							$('#distribution').attr('href' , './fx/index.html')
						}
					},
					complete_info: function(e) { // 获取用户执行完回调
						if($('#App').data('key') == 'queryApp') {
							startQuerying()
						}
					},
					exitLogin: function(e) {
						$('#distribution').attr('href' , './fx/init.html')
					}
				});
				
				if(data.domain_config && data.domain_config.distribution_status) {
					$('.distributionEntrance').show()
				}
				if(data.project[0].act_list.length > 0) {
					$('.nav-activity').show()
					if($(".resultBox")[0]) {
						$('.nav-activity').css('display', 'inline-block')
					}
					if($('.welfare-entrance')[0]){
						$('.welfare-entrance').css('display', 'inline-block')
					}
				}
			}else{
				cocoMessage.error(result.codeMsg, 2000);
			}


			// pay的二维码需要后端支付类型,
			// 本意是在index存储后, pay判断是否存在数据,
			// 存在数据就可以减少二维码的刷新时间, 不必等待info的接口完成后刷新二维码
			// 但sessionStorage在iframe会发生找不到的情况报错

			// if(!(sessionStorage.getItem("pay_way")) && $('#payHtml').length) {
			// payWay(data.project[0].pay_way)
			// }
			// sessionStorage.setItem("pay_way", JSON.stringify(data.project[0].pay_way));
		}
	});
}

var typeData = {}
var sequenceArr = []
function typefun(goods_info) {
	for(var i=0; i<goods_info.length; i++) {
		if(typeData.hasOwnProperty(goods_info[i].type)) {
			typeData[goods_info[i].type].push(goods_info[i])
		}else{
			typeData[goods_info[i].type] = [ goods_info[i] ]
			sequenceArr.push(goods_info[i].type)
		}
	}
}
function setArguments(info) {
	for (var i=0;i<info.length; i++){
		parameterSet[info[i].short_name] = info[i].goods_config
	}
}

$(function (){
	window.setHeight = function (){
		$(".boxLeft").css('height', 'auto')
		$(".rightCont").css('height', 'auto')
		if($('.boxLeft').outerHeight() > $(".rightCont").outerHeight()){
			$(".rightCont").css('height', $('.boxLeft').outerHeight())
			$(".foot").show()
		}

		if($(window).width() > 994){
			if(window.sessionStorage.getItem('editionKey') == 'advanced' && $('.rightCont').height() < 982){
				$(".boxLeft").css('height', '982px')
				return
			}
			$(".boxLeft").css('height',$('.rightCont').height())
		}else{
			$(".boxLeft").css('height','auto')
		}

	}
	setHeight()
	window.onresize = function (){
		window.setHeight()
	}
})

$('.Toggle2').click(function () {
	if(!isclick) return;
	$('.VersionSwitchingLoding').show()
	var this_ = $(this)
	setTimeout(function() {
		$('.VersionSwitchingLoding').hide();
		if(this_.attr('edition-key') == 'Normal'){		// 切换后
			if(parameterSet.bylwsenior.submit_attribute.value.education.value){
				$(".education_c").show()
			}else{
				$(".education_c").hide()
			}
			if(parameterSet.bylwsenior.submit_attribute.value.keyword.value){
				$(".keywordBox").show()
			}else{
				$(".keywordBox").hide()
			}
			if(parameterSet.bylwsenior.submit_attribute.value.major.value){
				$(".major").show()
			}else{
				$(".major").hide()
			}
			$(".EnglishLiterature").show()
		}
		if(this_.attr('edition-key') == 'advanced'){	// 切换后
			if(parameterSet.bylw.submit_attribute.value.education.value && (typeData[$("#type_s").val()].short_name == 'bylw')){
				$(".education_c").show()
			}else{
				$(".education_c").hide()
			}
			if(parameterSet.bylw.submit_attribute.value.keyword.value && (typeData[$("#type_s").val()].short_name == 'bylw')){
				$(".keywordBox").show()
			}else{
				$(".keywordBox").hide()
			}
			if(parameterSet.bylw.submit_attribute.value.major.value && (typeData[$("#type_s").val()].short_name == 'bylw')){
				$(".major").show()
			}else{
				$(".major").hide()
			}
			$(".proposal-check").trigger('change')
		}
	}, 500)
});


// 英文参考文献判断
function LiteratureFU() {
	var LiteratureType = $('input:checkbox[name="LiteratureType"]').is(':checked');
	if(LiteratureType && !$('#NumberEnglishReference').val()) {
		$("#LiteratureType_err").show()
		$(".inputQuantity .form-control").addClass('errorBorder')
		return false
	}else {
		$("#LiteratureType_err").hide()
		$(".inputQuantity .form-control").removeClass('errorBorder')
		return true
	}
}



$(window).scroll(function() {
	scrollTop($(this))
});

function scrollTop(this_) {
	if(this_.scrollTop() > 800) { 
        $('.toTop').show()
    }
	else{
		$('.toTop').hide()
	}
}
scrollTop($(window));